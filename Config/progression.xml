<?xml version="1.0" encoding="utf-8" ?>
<!--
  Demonata Gaming Metadata Format ©2025
  SPDX-License-Identifier: LicenseRef-DemonataGaming-Metadata-1.0
  See LICENSE.md for terms.
-->
<!--
  ==================================================
  Attribute Scaling & Leveling System Rebalance
  @version    1.2.0
  @date       2025-12-17
  @author     Demonata Gaming

  @group    Perks and Attributes Rework
  @description
    Rebalances core player progression by flattening attribute-based headshot bonuses,
    refining level pacing, and raising perk costs to promote long-term build commitment.
    Emphasizes deliberate progression and survival strategy over rapid power gain.
    Reintegrates Well Insulated perk. Makes Honey Crafting unlockable from the Wasteland
    Treasures Vol 1 book.
  @notes
    - Converts DamageModifier (headshot) effects from perc_add to base_add to eliminate exponential
      stacking.
    - Leveling curve begins at 6,500 XP and scales at 30% per level.
    - XP scaling caps at level 40 to prevent runaway endgame grind.
    - Perk and attribute upgrade costs increase by 25% per level, requiring strategic investment.
    - Intended to complement crafting-centric, headshot-reliant gameplay with limited XP sources.
  ==================================================
-->
<configs>
  <!--
  ===============================
  SECTION: HEADSHOT DAMAGE - ATTRIBUTE BONUSES
  ===============================
  @group    HeadshotDamageNormalization
  @desc
    Prevents stacking of multiple multiplicative effects by normalizing attributes to base_add.
  @xref     entityclasses.xml → SECTION: HEADSHOTS ONLY - RANGED COMBAT PERKS & DAMAGE MULTIPLIERS
  -->
  <!-- Perception -->
  <set xpath="/progression/attributes/attribute[@name='attPerception']/effect_group/passive_effect[@name='DamageModifier' and @tags='head']/@operation">
    base_add</set>
  <!-- Strength -->
  <set xpath="/progression/attributes/attribute[@name='attStrength']/effect_group/passive_effect[@name='DamageModifier' and @tags='head']/@operation">
    base_add</set>
  <!-- Fortitude -->
  <set xpath="/progression/attributes/attribute[@name='attFortitude']/effect_group/passive_effect[@name='DamageModifier' and @tags='head']/@operation">
    base_add</set>
  <!-- Agility -->
  <set xpath="/progression/attributes/attribute[@name='attAgility']/effect_group/passive_effect[@name='DamageModifier' and @tags='head']/@operation">
    base_add</set>
  <!-- Intellect -->
  <set xpath="/progression/attributes/attribute[@name='attIntellect']/effect_group/passive_effect[@name='DamageModifier' and @tags='head']/@operation">
    base_add</set>
  <!--
  ===============================
  SECTION: PLAYER LEVELING AND PERK SCALING
  ===============================
  @desc
    Adjusts player XP gain curve and perk costs to enforce pacing, increase difficulty,
    and make skill point allocation more meaningful.
  @group    PlayerProgression
  @notes
    - Base XP to level starts at 9,000 (vanilla: 10,000).
    - XP per level increases by 4% (vanilla: 5%).
    - XP cost per level clamps at level 50 (vanilla: 60).
    - Skill points per level: 1 (unchanged).
    - Attribute upgrade cost scales by 16% per rank (vanilla: 14%).
    - Late-game per-level cost after the clamp is ~61,500 XP vs ~177,897 in vanilla (≈65% lower).
    - Requires ~34% less XP to reach level 50 and ~64% less XP to reach level 300 compared to vanilla progression.
    - Rationale: These changes offset reduced XP income (kills + quests only).
  @xref     quests.xml → MAIN: Quest Rewards Patch — Challenge Turn-In XP Grants
  @xref     entityclasses.xml → SECTION: PLAYER XP RESTRICTIONS & WASTELAND GAMESTAGE GATE
  -->
  <set xpath="/progression/level/@exp_to_level">9000</set>
  <set xpath="/progression/level/@experience_multiplier">1.04</set>
  <set xpath="/progression/level/@clamp_exp_cost_at_level">50</set>
  <set xpath="/progression/level/@skill_points_per_level">1</set>
  <set xpath="/progression/attributes/@cost_multiplier_per_level">1.16</set>
  <!--
  ===============================
  SECTION: WELL INSULATED PERK REINTEGRATED
  ===============================
  @group      PlayerBuffStatusChanges
  @desc         Ties the Well Insulated perk to the the elemental buffs.
  @notes       These changes rely on changes in the progression system.
  @xref          buffs.xml → SECTION: WELL INSULATED BUFF REINTEGRATED
  -->
  <append xpath="/progression/perks">
    <perk name="perkWellInsulated" max_level="3" parent="skillFortitudeSurvival" name_key="perkWellInsulatedName" desc_key="perkWellInsulatedDesc" icon="ui_game_symbol_temperature">
      <level_requirements level="1">
        <requirement name="ProgressionLevel" progression_name="attFortitude" operation="GTE" value="1" desc_key="reqFortitudeLevel01"/>
      </level_requirements>
      <level_requirements level="2">
        <requirement name="ProgressionLevel" progression_name="attFortitude" operation="GTE" value="4" desc_key="reqFortitudeLevel04"/>
      </level_requirements>
      <level_requirements level="3">
        <requirement name="ProgressionLevel" progression_name="attFortitude" operation="GTE" value="7" desc_key="reqFortitudeLevel07"/>
      </level_requirements>
      <effect_group>
        <passive_effect name="HypothermalResist" operation="base_add" level="1,2,3" value="10,20,20"/>
        <passive_effect name="HyperthermalResist" operation="base_add" level="1,2,3" value="10,20,20"/>
        <!-- T3 effect is in buffElementHot/buffElementCold -->
        <effect_description level="1" desc_key="perkWellInsulatedRank1Desc" long_desc_key="perkWellInsulatedRank1LongDesc"/>
        <effect_description level="2" desc_key="perkWellInsulatedRank2Desc" long_desc_key="perkWellInsulatedRank2LongDesc"/>
        <effect_description level="3" desc_key="perkWellInsulatedRank3Desc" long_desc_key="perkWellInsulatedRank3LongDesc"/>
      </effect_group>
      <effect_group>
        <!-- Increase the chance to find Fireman's Almanac books until each book is read -->
        <passive_effect name="LootProb" operation="perc_add" level="1,3" value="2,10" tags="firemansProb">
          <requirement name="ProgressionLevel" progression_name="perkFiremansAlmanacComplete" operation="LT" value="1"/>
        </passive_effect>
        <!-- When all Fireman's Almanac books have been read, set the probability bonus of finding them to 0 -->
        <passive_effect name="LootProb" operation="perc_add" level="1,3" value="1,1" tags="firemansProb">
          <requirement name="ProgressionLevel" progression_name="perkFiremansAlmanacComplete" operation="Equals" value="1"/>
        </passive_effect>
      </effect_group>
    </perk>
  </append>
  <!--
  ===============================
  SECTION: HONEY CRAFTING UNLOCK
  ===============================
  @group    Collectors
  @desc       Makes the honey recipe unlockable from reading
                      Wasteland Treasures Vol 1.
  @xref       recipes.xml → SECTION: EMPTY JARS HONEY AND WATER CHANGES
  -->
  <append xpath="/progression/perks/book[@name='perkWasteTreasuresHoney']/effect_group">
    <passive_effect name="RecipeTagUnlocked" operation="base_set" level="1" value="1" tags="foodHoney"/>
  </append>
</configs>
